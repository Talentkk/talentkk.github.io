---
title: 20211016模拟
---

## Problem A

给定一个长度为 $n$ 的序列 $a$ 和一个参数 $k$ 。问对于将序列 $a$ 重复 $k$ 次的序列 $b$ ，它的逆序对是多少。

<!--more-->

$1\leq n,a_i\leq 5000,1\leq k\leq 10^6$

把 $b$ 中的每一个 $a$ 序列看成一个段。然后把逆序对直接分成段内的和段外的计算。时间复杂度 $O(n^2)$ 。

## Problem B

给出平面上的 $n$ 个点，现在可以给点之间两两连边，边权是两点欧几里得距离的平方。对于一种方案，代价是连通块个数乘 $v$ 加边权和。求最小代价。

$1\leq n\leq5000 ,0\leq v\leq 10^5,0\leq x,y\leq 30000$

显然有环不优。所以可以先求一棵最小生成树，然后把边权大于 $v$ 的断掉即可。求最小生成树时用 `Prim` 可以 $O(n^2)$ 。

## Problem C

一个人在数轴上，每秒可以向左移动一个单位，向右移动一个单位，或原地不动。初始位置为 $0$ ，他要到达位置 $e$ ，途中有 $n$ 个景点依次位于 $x_1,x_2...x_n$ （升序）。一个景点到达即可参观，但参观完一次后要等 $t$ 秒才能参观下一次。如果这个人想在途中参观每个景点至少两次，最少需要多少时间。

$1\leq n\leq 100000,1\leq e,t\leq 10^9,0<x_1<x_2<...<x_n<e$

观察可得最优方案一定是每次都参观完一个连续段，再参观下一个连续段。即如果返回，一定会把当前点前面没有参观完的（两次）都参观完。所以容易得到 $O(n^2)$ 的 $dp$ ，设 $dp_i$ 为参观完 $1$ 到 $i$ 的最少时间。转移为：
$$
dp_i=\min(dp_j+a_i-a_{j-1}+\max(2\times (a_i-a_j),t))
$$
 对于后面的 $\max$ 讨论下取值，如果当前 $dp$ 到 $i$ ，那么一定是一个前缀的 $j$ 取到 $\max$ 左边，其余的取到 $\max$ 右边。所以可以两个分别维护（用单调队列）。时间复杂度 $O(n)$ 。

## Problem D

给定三个正整数 $x,y,z$ ，定义一个序列 $a$ 是好的，当且仅当这个序列存在三个相邻的连续字段，它们的和分别是 $x,y,z$ 。问所有长度为 $n$ ，值域在 $[1,10]$ 之间的序列有多少是好的。

$1\leq n\leq 50,1\leq a,b,c\leq 6$

考虑计算有多少序列是不好的。注意到这三个连续段的和不超过 $18$ ，所以可以设 $dp_{i,j}$ 表示，考虑序列的前 $i$ 个元素，前 $i$ 个元素构成的序列是不好的，且后缀和的集合为 $j$ 的方案数。因为后缀和是单增的，所以可以直接状压是否存在后缀和为 $x$ 的后缀。转移时直接枚举下一个字符并检查序列是否会变好。

<iframe src="/pdf/20211016C.pdf" width="100%" height="500px"></iframe>
