---
title: TPC1089
date: 2021/12/4
description: 　
---

给两个长度相同的字符串 $S$ 和 $T$ ，以及 $n$ 对长度相同的字符串 $x_i,y_i$ ，现在要把 $S$ 变成 $T$ ，每次操作可以把当前字符串一个为 $x_i$ 的后缀替换成 $y_i$ ，求最小操作次数。

$1\leq|S|,|T|,|x_i|,|y_i|\leq 20,1\leq n\leq 100$ ，包含大小写字符。

考虑暴力的做法，建出大小为 $20^{52}$ 的图，然后连边跑最短路即可。

假设 $|S|=|T|=l$ 。

考虑一种类似分层的算法。设 $f(a,b,l)$ 表示：**仅通过长度不超过 $l$ 的修改操作**从字符串 $a$ 变到字符串 $b$ 的最小操作次数，我们在处理 $l$ 之前先把 $l-1$ 的处理好。观察可以发现，对于 $f(a,b,l)$ 这个状态，只有当 $a,b$ 都是 $S,T,x_i,y_i$ 中某个长度为 $l$ 的后缀时，才是后面所关心的。对于一个 $l$ 的转移，我们先赋上初始状态：$f(a,b,l)=1(a=x_i,b=x_y),f(a,b,l)=f(a',b',l-1)(a_0=b_0)$ ，其中 $a',b'$ 表示 $a,b$ 去掉首位。然后再跑一遍 `floyd` ，就可得出所有 $f(a,b,l)$ 。由于我们把一层的节点数简化到了 $O(n)$ ，所以时间复杂度 $O(n^3\times l)$ 。 

