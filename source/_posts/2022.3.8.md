---
title: 2022.3.8
date: 2022/3/8
description: 　
---

## 「雅礼集训 2017 Day2」棋盘游戏

对原图中的每一个格子建出一个点，在相邻的格子间连边，会得到一张二分图。一个重要的结论是：

+ 对于一个点 $u$ ，若这张二分图存在一个**最大匹配**不包含 $u$ ，则 Alice 必胜，否则 Bob 必胜。

证明如下：

1. 当这张图存在一个不包含 $u$ 的最大匹配。Alice 的必胜策略为每次沿着当前点唯一的匹配边走。假设 Alice 采用这样的策略 Bob 获得了胜利，那么两人走过的边依次是：未匹配边 - 匹配边 - ...... - 未匹配边，且由于 Alice 最后一步无路可走，所以最后一个点是未匹配点。那么这张图就存在一条增广路，与最大匹配的假设矛盾。
2. 但这张图的每一个最大匹配都包含 $u$ 。Bob 的必胜策略是每次沿着当前点唯一的匹配边走。假设 Bob 采用这样的策略 Alice 取得了胜利，那么两人走过的边依次是：匹配边-未匹配边- ...... -未匹配边，且由于 Bob 最后一步无路可走，所以最后一个点是未匹配点。那么将这条路径上的匹配与未匹配边翻转以后，$u$ 将不在匹配中，且依然是最大匹配，与原假设矛盾。

也就是说现在只需要判断一个点是否一定在最大匹配中。这是简单的，只需要先求出任意一组最大匹配，然后检查是否存在一条从 $u$ 出发的匹配边-未匹配边- ...... - 未匹配边，且终点是未匹配点的路径即可。时间复杂度 $O(n^2m^2)$ 。

## CF1648D Serious Business

一个显然的 $O(n^2)$ 做法是枚举进入第二行的列 $l$ 与离开第二行的列 $r$ ，并计算答案，但难以优化。

两个重要的观察是：

+ 选择的线段一定构成了一个连续的区间。
+ 选择的所有线段中，除了右端点最大的一条，其余的右端点都被经过。
+ 所有线段不相互包含，离开时的位置只在一条线段上。

这启发我们枚举离开的线段是哪条来计算答案。我们先预处理 $f_i$ 表示从 $(1,1)$ 走到 $(2,r_i)$ 的最小代价（把所有线段排序后按照右端点 $dp$ 即可），记 $b_{i,j}=\sum_{k=1}^{j}{a_{i,k}}$ 。

假设离开时所在的线段为 $x$ ，分两种情况考虑：

+ $x$ 是唯一选择的一条线段，即求一对 $(i,j)$ 满足 $l_x\leq i\leq j\leq r_x$ ，使得 $b_{1,i}+b_{2,j}-b_{2,i-1}$ 最小。
+ $x$ 不是唯一选择的一条线段，枚举选择的上一条线段 $y$ 的右端点 $i$ ，即求一对 $(i,j)$ 满足 $l_x-1\leq i<j\leq r_x$ ，使得 $f_y+b_{1,j}-b_{1,i-1}+b_{2,n}-b_{2,j-1}$ 。

可以用线段树维护，时间复杂度 $O(n\times \log n)$ 。

## ARC118F Growth Rate

设 $lim_i$ 表示 $x_i$ 最大可以填多少，设 $dp(i,j)$ 表示考虑 $[i,n+1]$ 的所有数，$x_i=j$ 的方案数。$dp$ 的转移为：
$$
dp(i,j)=\sum_{k=a_i\times j}^{lim_{i+1}}{dp(i+1,k)}
$$
时间复杂度较高，考虑优化。

设 $F_i(x)$ 为一个多项式，满足 $F_i(j)=dp(i,j)$ 。考虑知道了 $F_{i+1}$ ，怎么求 $F_i$ 。记 $G_i(x)=\sum_{y\leq x}{F_i(x)}=\sum_{i}{f_i\sum_{y\leq x}{y^i}}$ ，则 $F_k(x)=\sum_{y\geq a_kx}{F_{k+1}(y)}=G_{k+1}(lim_{k+1})-G_{k+1}(a_kx-1)$ 。

根据上面的转移式我们可以得知，假设 $F_{i+1}(x)$ 是一个 $p$ 次多项式，则 $F_{i}(x)$ 是一个 $p+1$ 次多项式，而 $F_{n+1}$ 是一个零次多项式，说明 $F_1(x)$ 的次数是 $O(n)$ 的。于是我们可以直接维护点值，转移时要使用拉格朗日插值，时间复杂度 $O(n^3)$ 。但是注意到 $a_i = 1$ 的位置可以 $O(n)$ 转移（不需要使用拉格朗日插值），故时间复杂度优化至 $O(n^2\log n)$ 。