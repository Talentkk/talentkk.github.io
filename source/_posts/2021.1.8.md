---
title: 2021.1.8
date: 2022/1/8
description: 　
---

## CF1525F

给一个 $n$ 个点 $m$ 条边的有向无环图，有 $k$ 次事件发生：第 $i$ 次事件要求这个图的最小链覆盖数大于 $i$ 。每次事件发生前可以进行以下操作任意次：

+ 删去 $i$ 的所有入边
+ 删去 $i$ 的所有出边

假设第 $i$ 次事件前操作了 $c_i$ 次，获得的总分是 $\sum{\max(0,x_i-c_i*y_i)}$ ，求得分最大是多少。要求输出任意方案。

$2\leq n\leq 50,0\leq m\leq \frac{n(n-1)}{2},1\leq k\leq n-1,1\leq x_i,y_i\leq 10^9$

考虑对于一个有向无环图如何求最小链覆盖。

问题等价于使得所有链的边长之和最大。假设从图中选取了若干链上的边，则每个点应该满足出度和入度均小于等于 $1$ 。我们把每个点拆成入点和出点，对于原图中的一条边 $(u,v)$ ，把 $u$ 的出点和 $v$ 的入点连边。假设这个二分图的最大匹配是 $w$ ，$n-w$ 就是最小链覆盖的答案。

容易发现，题目中删去入边的操作，等价于删去新图中的入点，删去出边的操作，等价于删去新图中的出点。

两个重要的观察是：

+ 对于任何一个二分图，删去一个点后，最大匹配最多减 $1$ （显然）。

+ 对于任何一个最大匹配不为 $0$ 的二分图，一定存在一个点，使得删去它后，最大匹配恰好减 $1$ 。

  证明：求出此图任意一个最大匹配的方案，并找到其对应的最小点覆盖的方案。任何一个最小点覆盖中的点均满足条件。

由上述观察可得知，一次操作一定会使最小链覆盖的答案加 $1$ 。所以设 $dp(i,j)$ 表示考虑前 $i$ 次事件，最小链覆盖的答案为 $j$ 时的最大得分，转移时枚举当前事件前，进行多少次操作即可。

此题还要求输出方案，根据记录 $dp$ 的转移我们可以知道在每次事件前分别进行了几次操作。现在的问题是如何求出依次删去哪些点，才能使得每次最大匹配恰好减一。由于 $n\leq 50$ ，所以可以直接枚举删去一个点是否可行，时间复杂度 $O(n^5)$ 。

## CF1519E

平面上有 $n$ 个点,每个点坐标为一个分数。每个点必须选择向上或向右移动一个单位 ($y+1$ 或 $x+1$ )。对于移动后的点，每次可以选择与 $(0,0)$ 三点共线的点对(重合也算)，将该点对的点除去。问在最优方案下最多能除去多少对点（每个点只能被除去一次），要求输出方案。

$1\leq n\leq 2\times 10^5$

容易发现两个点可以匹配当且仅当它们斜率相同，对于一个点，我们把它可以移动得到的两个斜率之间连边，则问题转化为：给定一个无向图，两条边可以匹配当且仅当它们至少有一个公共点，求最大匹配。

我们对每一个连通块分开考虑，对于一个含有 $m$ 条边的连通块，最大匹配的上界是 $\lfloor\frac{m}{2}\rfloor$ ，容易发现这个上界是容易构造的。

时间复杂度 $O(n\times\log(n))$ ，瓶颈在于离散化和 $gcd$ 。

## CF1519F

给定 $n,m$ 表示存在 $n$ 个宝箱和 $m$ 把钥匙，第 $i$ 把钥匙需要 $b_i$ 元，第 $i$ 个宝箱内部有 $a_i$ 元。

现在进行一场游戏，Bob 是本场游戏的玩家，而 Alice 则是场景布置者，Alice 可以给每个宝箱上一些锁（第 $j$ 种锁需要第 $j$ 种钥匙打开）

如果 Bob 可以购买一些钥匙，然后打开一些宝箱，使得 Bob 的收益大于 $0$，那么 Bob 就赢得了游戏，反之 Alice 获得了胜利。

现在 Alice 打算布置宝箱上的锁，第 $i$ 个宝箱上放置第 $j$ 种锁的花费为 $c_{i,j}$ ，请帮助 Alice 找到一种布置锁的方案，使得花费最小，且 Alice 将取得胜利。

$n,m\leq 6,a_i,b_i\leq 4,c_{i,j}\leq 10^7$

特别的，一个箱子上可以放置若干把锁，Bob 需打开所有锁才能获得内部的钱。

容易发现，对于一个布置锁的方案，Alice 获胜的条件等价于：对于任意宝箱的集合 $S$ ，假设集合 $S$ 中锁的集合为 $T$ ，满足 $\sum_{i\in S}{a_i}\leq \sum_{i\in T}{b_i}$ 。这个条件与 `Hall` 定理类似，考虑把问题转化为二分图。

把第 $i$ 个宝箱拆成 $a_i$ 个点，放在左部；把第 $i$ 个钥匙拆成 $b_i$ 个点，放在右部。在第 $i$ 个箱子上放第 $j$ 把锁相当于把对应的 $a_i$ 个点分别向对应的 $b_i$ 个点连边。现在问题就转化为：按照上述规则连边，求使得这个二分图有完美匹配的最小代价。

设 $dp(i,s)$ 表示考虑前 $i$ 个宝箱，与集合 $S$ 的钥匙匹配的最小代价，转移时枚举当前宝箱的每一个点分别与哪个钥匙匹配即可。时间复杂度 $O(n\times 5^{2n})$ 。

