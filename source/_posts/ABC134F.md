---
title: ABC219H
date: 2021/12/17
description: 　
---

## ABC134F

求有多少长度为 $n$ 的排列满足 $\sum_{i=1}^{n}{|i-p_i|}=k$ ，对 $998244353$ 取模。

$1\leq n\leq 50,0\leq k\leq n^2$

考虑从 $i$ 向 $p_i$ 连边，记 $i,i+1$ 这条线段被覆盖的次数是 $s_i$ ，则 $\sum_{i=1}^{n}{|i-p_i|}=\sum_{i=1}^{n-1}{s_i}$ 。这样就可以 $dp$ 了。

设 $dp(i,j,k)$ 表示仅考虑前 $i$ 个点，其中有 $j$ 个点未连出边，$\sum_{j=1}^{i-1}{s_j}=k$ 的方案数。

转移时讨论 $i$ 是否向其它点连边（即令 $p_i=j,j\in[1,i]$） ，是否有点连向 $i$ （$p_j=i$ ，$j\in[1,i]$），即可转移。

时间复杂度 $O(n^4)$ 。