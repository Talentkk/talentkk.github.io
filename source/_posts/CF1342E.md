---
title: CF1342E
date: 2021/12/3
description: 　
---

在 $n \times n$ 的国际象棋棋盘上放 $n$ 个车，要求满足两个条件：

- 所有的空格子都能被至少一个车攻击到。
- **恰好**有 $k$ 对车可以互相攻击到。

答案对 $998244353$ 取模。

$1\leq n\leq 2\times 10^5,0\leq k\leq \frac{n\times(n-1)}{2}$

先对 $k=0$ 进行特判，答案为 $n!$ 。

容易发现每一行都有车和每一列都有车之中必有一个成立，且不可能同时成立。由于两种情况完全相同，所以只要计算出每一行都有车的方案数即可。对于每一列，如果有 $x$ 个车，若 $x=0$ ，则不会对答案造成影响；若 $x>0$ 会对答案造成 $x-1$ 的贡献。综上不存在车的列有 $k$ 个。

设 $f_k$ 为每行放一个车，恰有 $k$ 列没有车的方案数，也就是答案。

再设 $g_k$ 为钦定 $k$ 列没有车，其它列任意的方案数，容易得到 $g_k={n\choose k}(n-k)^n$ 。考虑用 $f$ 来表示 $g$ ，枚举最终有了 $i$ 个行是空的，则有：
$$
g_k=\sum_{i=k}^{n}{f_i{i\choose k}}
$$
根据二项式反演：
$$
f_k=\sum_{i=k}^{n}{(-1)^{i-k}g_i{i\choose k}}
$$
时间复杂度 $O(n)$ 。