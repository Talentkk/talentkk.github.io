---
title: ARC131D
date: 2021/12/10
description: 　
---

给一个数轴，你要在上面选 $n$ 个点，两点之间的距离至少是 $d$ 。再给出 $r_0=0<r_1<r_2<...<r_m$ 和 $s_0>s_1>...s_{m-1}>0$ ，表示对于一个在坐标 $x$ 的点：

+ 若 $x=0$ ，获得 $s_0$ 的得分。
+ 若 $r_{i}<|x|\leq r_{i+1}$  ，获得 $s_i$ 的得分。
+ 若 $|x|>r_m$ ，获得 $0$ 分。

求得分的总和最大是多少。

$1\leq n\leq 10^5,1\leq m\leq 10^5,1\leq d\leq 10^6,r_i,s_i\leq 10^{11}$

两个重要的观察：

1. 最优策略下，两点之间的距离恰好是 $d$ 。
2. 第 $\lfloor \frac{n}{2} \rfloor$ 个点在区间 $[-d,d]$ 中。

两个观察都容易用反证法证明。现在就是要计算起点在一个连续区间内 （长度为 $2d$）的得分分别是多少，假设区间为 $[l,r]$ 。暴力计算 $l$ 为起点的代价，然后考虑把起点向右移动，并计算变化量。注意当且仅到当一个点向右移动，进入到一个新的得分段时，得分会发生变化，显然在起点从 $l$ 到 $r$ 的过程中，这样的变化次数是 $O(n)$ 的。我们直接对于一开始每个点 $l,d+l,2d+l,...,(n-1)d+l$ 分别计算每个点在移动过程中，对答案的变化量的贡献即可。时间复杂度线性。
