---
title: ARC133C
date: 2022/1/15
description: 　
---

给定一个 $n\times m$ 的方格，你要给每一个格子中填入 $[0,k-1]$ 中的整数，使得：

+ 对于 $1\leq i\leq n$ ，第 $i$ 行所有格子中的数之和模 $k$ 等于 $A_i$ 。
+ 对于 $1\leq i\leq m$ ，第 $i$ 列所有格子中的数之和模 $k$ 等于 $B_i$ 。

问所有格子中的数之和最大能是多少。

$1\leq n,m,k\leq 200000$ 

参照官方题解做法。

考虑先给每个格子填上 $k-1$ ，然后通过调整使得满足题中条件。现在问题等价于使得减去的值的和尽可能小。

我们令 $C_i$ 为第 $i$ 行需要减去的值模 $k$ ，$D_i$ 表示第 $i$ 列需要减去的值模 $k$ 。

注意到我们每次进行对 $(i,j)$ 减 $1$ 操作时，$C_i,D_j$ 要同时减一（模意义下），所以 $\sum{C_i}$ 要和 $\sum{D_i}$ 相同，否则无解。

设 $Z=\max(\sum{C_i},\sum{D_i})$ ，则减去值的下界显然是 $Z$ 。接下来我们证明这个下解是可以取到的：

+ 若 $\sum{C_i}>\sum{D_i}$ ，$D_1\leftarrow D_1+\sum{C_i}-\sum{D_i}$ ，否则 $C_1\leftarrow C_1+\sum{D_i}-\sum{C_i}$ 。
+ 不断重复以下操作：找到 $(i,j)$ 满足 $C_i>0,D_i>0$ ，然后给 $(i,j),C_i,D_i$ 分别减一。

容易证明这样的构造是符合题意的。

